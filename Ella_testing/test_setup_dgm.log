
. siman which
C:\ian\git\siman\siman.ado
*!version 0.9  14jun2024
C:\ian\git\siman\siman_setup.ado
*!      version 0.10.1  11jun2024       
C:\ian\git\siman\siman_describe.ado
*! version 0.6   8may2024       IW no longer removes underscores from display
C:\ian\git\siman\siman_analyse.ado
*! version 0.9.1        14jun2024               IW remove code for nformat!=1 and nmethod!=1
C:\ian\git\siman\siman_table.ado
*! version 0.8.3   3apr2024
C:\ian\git\siman\siman_lollyplot.ado
*! version 1.13.2  15dec2023
C:\ian\git\siman\siman_zipplot.ado
*!  version 1.9 22apr2024
C:\ian\git\siman\siman_comparemethodsscatter.ado
*! version 1.9.19 2may2024
C:\ian\git\siman\siman_blandaltman.ado
*!  version 1.7 22apr2024
C:\ian\git\siman\siman_swarm.ado
*! version 1.10 22apr2024
C:\ian\git\siman\siman_scatter.ado
*! version 1.7 22apr2024
C:\ian\git\siman\siman_nestloop.ado
*! version 1.8.2   17aug2023

. 
. forvalues dgmtype = 1/5 {
  2.         di as input "dgmtype = `dgmtype'"
  3.         use c:\temp\extendedtestdata, clear
  4.         if `dgmtype'==1 {
  5.                 keep if beta==1 & pmiss==1 & mech=="MCAR"
  6.                 drop beta pmiss mech
  7.                 local dgmopt
  8.                 local xdgm 
  9.                 local xndgmvars 0
 10.         }
 11.         if `dgmtype'==2 {
 12.                 keep if beta==1 & pmiss==1 & mech=="MCAR"
 13.                 drop pmiss mech 
 14.                 local dgmopt dgm(beta)
 15.                 local xdgm beta
 16.                 local xndgmvars 1
 17.         }
 18.         if `dgmtype'==3 {
 19.                 keep if beta==1 & pmiss==1 
 20.                 drop beta pmiss
 21.                 local dgmopt dgm(mech)
 22.                 local xdgm mech
 23.                 local xndgmvars 1
 24.         }
 25.         if `dgmtype'==4 {
 26.                 keep if beta==1
 27.                 drop beta
 28.                 local dgmopt dgm(pmiss mech)
 29.                 local xdgm pmiss mech
 30.                 local xndgmvars 2
 31.         }
 32.         if `dgmtype'==5 {
 33.                 local dgmopt dgm(beta pmiss mech)
 34.                 local xdgm beta pmiss mech
 35.                 local xndgmvars 3
 36.         }
 37.         local xdgmcreated 0
 38.         qui siman setup, rep(re) `dgmopt' target(estim) method(meth) estimate(b) se(se) true(tr
> uev)
 39.         foreach thing in dgm ndgmvars dgmcreated {
 40.                 local xx `: char _dta[siman_`thing']'
 41.                 cap assert "`x`thing''" == "`xx'"
 42.                 if _rc {
 43.                         di as error "Error with dgmtype = `dgmtype':"
 44.                         di "_dta[siman_`thing'] = `xx' but should be `x`thing''"
 45.                 }
 46.         }
 47.         qui count if method=="CCA"
 48.         local x = r(N)
 49.         siman analyse if method=="MeanImp", notable
 50.         qui count if method=="CCA"
 51.         assert `x' == r(N)
 52.         siman analyse if method=="Noadj", notable replace
 53.         qui count if method=="CCA"
 54.         assert `x' == r(N)
 55. }
dgmtype = 1
(99,000 observations deleted)
siman analyse has run successfully
siman analyse has run successfully
dgmtype = 2
(99,000 observations deleted)
siman analyse has run successfully
siman analyse has run successfully
dgmtype = 3
(90,000 observations deleted)
siman analyse has run successfully
siman analyse has run successfully
dgmtype = 4
(72,000 observations deleted)
siman analyse has run successfully
siman analyse has run successfully
dgmtype = 5
siman analyse has run successfully
siman analyse has run successfully

. 
. di as result "*** SIMAN HAS PASSED ALL THE TESTS IN `filename'.do ***"
*** SIMAN HAS PASSED ALL THE TESTS IN test_setup_dgm.do ***

. 
. log close
